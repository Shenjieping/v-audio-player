!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).AudioPlayer=e()}(this,function(){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function e(t){return(e="function"==typeof Symbol&&"symbol"==n(Symbol.iterator)?function(t){return n(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function u(){var e=this;i(this,u),r(this,"touchStart",function(t){e.resetTouchStatus(),e.startX=t.touches[0].clientX,e.startY=t.touches[0].clientY}),r(this,"touchMove",function(t){t=t.touches[0];e.deltaX=t.clientX-e.startX,e.deltaY=t.clientY-e.startY,e.offsetX=Math.abs(e.deltaX),e.offsetY=Math.abs(e.deltaY)}),r(this,"resetTouchStatus",function(){e.deltaX=0,e.deltaY=0,e.offsetX=0,e.offsetY=0}),this.deltaX=0,this.deltaY=0,this.offsetX=0,this.offsetY=0}function s(t){return"function"==typeof t}function l(){var o=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i(this,l),r(this,"initHtml",function(){o.el.style.background=o.options.inactiveColor,o.el.innerHTML='\n      <div class="v-slider-bar">\n        <div class="v-slider__button-wrapper">\n          <div class="v-slider__button"></div>\n        </div>\n      </div>\n    ',o.el.querySelector(".v-slider__button").style.width=o.options.buttonSize,o.el.querySelector(".v-slider__button").style.height=o.options.buttonSize,o.options.barHeight&&(o.el.style.height=o.options.barHeight,o.el.querySelector(".v-slider-bar").style.height=o.options.barHeight)}),r(this,"updateValue",function(t,e){t=o.format(t);var i=o.options.input,n=o.options.change;i&&(s(i)?i.call(o,t):console.warn("input is not a function")),e&&n&&(s(n)?n.call(o,t):console.warn("change is not a function")),o.value=t,o.render()}),r(this,"format",function(t){return Math.round(Math.max(o.min,Math.min(t,o.max))/o.step)*o.step}),r(this,"onClick",function(t){t.stopPropagation();var e=o.el.getBoundingClientRect(),t=t.clientX-e.left,e=e.width,e=+o.min+t/e*o.scope;o.startValue=o.value,o.updateValue(e,!0)}),r(this,"onTouchStart",function(t){o.touchMixin.touchStart(t),o.currentValue=o.value,o.startValue=o.format(o.value),o.dragStatus="start"}),r(this,"onTouchMove",function(t){var e,i=o.options.dragStart;"start"===o.dragStatus&&i&&(s(i)?i():console.warn("dragStart is not a function")),o.el.querySelector(".v-slider-bar").style.transition="none 0s ease 0s",e=!0,"boolean"==typeof(i=t).cancelable&&!i.cancelable||i.preventDefault(),e&&i.stopPropagation(),o.touchMixin.touchMove(t),o.dragStatus="draging";t=o.el.getBoundingClientRect(),t=o.touchMixin.deltaX/t.width*o.scope;o.currentValue=o.startValue+t,o.updateValue(o.currentValue)}),r(this,"onTouchEnd",function(){var t;"draging"===o.dragStatus&&(o.updateValue(o.currentValue,!0),(t=o.options.dragEnd)&&(s(t)?t():console.warn("dragEnd is not a function"))),o.el.querySelector(".v-slider-bar").style.transition=null,o.dragStatus=""}),r(this,"bindTouchEvent",function(t){var e=o.onTouchStart,i=o.onTouchMove,n=o.onTouchEnd;t.addEventListener("touchstart",e),t.addEventListener("touchmove",i),n&&(t.addEventListener("touchend",n),t.addEventListener("touchcancel",n))}),r(this,"calcMainAxis",function(){var t=o.value,e=o.min,i=o.scope;return"".concat(100*(t-e)/i,"%")}),r(this,"calcOffset",function(){return o.value,o.min,o.scope,null}),r(this,"render",function(){var t={width:o.calcMainAxis(),background:o.options.activeColor},e=o.el.querySelector(".v-slider-bar");e.style.width=t.width,e.style.background=t.background}),this.options=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({min:0,max:100,step:1,value:0},t),this.min=this.options.min,this.max=this.options.max,this.step=this.options.step,this.value=this.options.value,this.el=function(t){if("string"==typeof t&&(t=document.querySelector(t)),("object"===("undefined"==typeof HTMLElement?"undefined":e(HTMLElement))?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"===e(t)&&1===t.nodeType&&"string"==typeof t.nodeName})(t))return t;throw TypeError("el is not define")}(this.options.el),this.dragStatus="",this.scope=this.max-this.min,this.initHtml(),this.updateValue(this.value),t=this.el.querySelector(".v-slider__button-wrapper"),this.bindTouchEvent(t),this.touchMixin=new u,this.el.addEventListener("click",this.onClick)}return function t(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"init",function(){i.el.querySelector(".title").innerHTML=i.title,i.audioEl.setAttribute("src",i.url),i.getAudioInfo(),i.el.querySelector(".icon-audio").addEventListener("click",i.playAndPause)}),o(this,"initHtml",function(){i.el.innerHTML='\n      <span class="icon icon-audio"></span>\n      <div class="audio-info">\n        <div class="title"></div>\n        <div class="v-slider"></div>\n        <div class="audio-time">\n          <div class="audio-current">00:00</div>\n          <div class="audio-duration">00:00</div>\n        </div>\n      </div>\n      <audio class="audio-wapper" preload></audio>\n    '}),o(this,"initFixSlider",function(){var t;i.options.showFixed&&((t=document.createElement("div")).className="audio-player-fixed",t.innerHTML='\n      <span class="icon icon-audio"></span>\n      <div class="audio-info">\n        <div class="title"></div>\n        <div class="v-slider"></div>\n        <div class="audio-time">\n          <div class="audio-current">00:00</div>\n          <div class="audio-duration">00:00</div>\n        </div>\n      </div>\n      <span class="icon icon-close-btn"></span>\n    ',i.fixAudio=t,document.body.appendChild(t),i.fixAudio.querySelector(".title").innerHTML=i.title,i.fixAudio.querySelector(".icon-audio").addEventListener("click",i.playAndPause),i.fixAudio.querySelector(".icon-close-btn").addEventListener("click",i.closeFixSlider),i.fixAudio.querySelector(".audio-duration").innerHTML=i.duration,i.fixSlider=new l({el:i.fixAudio.querySelector(".v-slider"),step:.1,value:i.currentTimeValue,buttonSize:i.options.buttonSize||"10px",activeColor:i.options.activeColor||"#F45E23",change:i.changeTime}))}),o(this,"closeFixSlider",function(){i.fixAudio&&(i.fixAudio.parentNode.removeChild(i.fixAudio),i.fixAudio=null,i.audioPause())}),o(this,"initSlider",function(){i.slider=new l({el:i.el.querySelector(".v-slider"),step:.1,buttonSize:i.options.buttonSize||"10px",activeColor:i.options.activeColor||"#F45E23",change:i.changeTime})}),o(this,"playAndPause",function(){i.play=!i.play,i.showPlayFixed=!0;var t=i.audioEl;i.play?(t.play(),i.initFixSlider()):(t.pause(),i.closeFixSlider()),i.options.playStatus&&i.options.playStatus(i.play,i.el.dataset.index)}),o(this,"audioPause",function(){i.showPlayFixed=!1,i.play=!1,i.audioEl.pause(),i.closeFixSlider()}),o(this,"changeTime",function(t){var e=i.audioEl;e.currentTime=e.duration*t/100}),o(this,"getAudioInfo",function(){var e=i.audioEl;e.addEventListener("loadedmetadata",function(){i.duration=i.transTime(e.duration),i.el.querySelector(".audio-duration").innerHTML=i.duration,i.fixAudio&&(i.fixAudio.querySelector(".audio-duration").innerHTML=i.duration)}),e.addEventListener("timeupdate",function(){var t=Math.floor(e.currentTime)/Math.floor(e.duration)*100;i.currentTimeValue=parseInt(100*t)/100,i.currentTime=i.transTime(e.currentTime),i.slider.updateValue(i.currentTimeValue),i.el.querySelector(".audio-current").innerHTML=i.currentTime,i.fixAudio&&(i.fixSlider.updateValue(i.currentTimeValue),i.fixAudio.querySelector(".audio-current").innerHTML=i.currentTime)}),e.addEventListener("ended",function(){i.play=!1,i.showPlayFixed=!1,e.pause(),i.currentTime="00:00",i.currentTimeValue=0,i.slider.updateValue(i.currentTimeValue),i.el.querySelector(".audio-current").innerHTML=i.currentTime,i.fixAudio&&i.closeFixSlider()},!1)}),o(this,"transTime",function(t){var e=parseInt(t),t=parseInt(e/60),e=e%60+"";return 0===t?t="00":t<10&&(t="0"+t),1===e.length&&(e="0"+e),t+":"+e}),this.options=e,this.url=this.options.url,this.title=this.options.title,this.el=function(t){if("string"==typeof t&&(t=document.querySelector(t)),("object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement))?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"===n(t)&&1===t.nodeType&&"string"==typeof t.nodeName})(t))return t;throw TypeError("el is not define")}(this.options.el),this.initHtml(),this.duration="00:00",this.currentTime="00:00",this.currentTimeValue=0,this.play=!1,this.showPlayFixed=!1,this.audioEl=this.el.querySelector(".audio-wapper"),this.init(),this.initSlider()}});
