!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).AudioPlayer=e()}(this,function(){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var t,e;return t=void 0,e=function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==o(Symbol.iterator)?function(t){return o(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":o(t)})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function u(){var e=this;i(this,u),r(this,"touchStart",function(t){e.resetTouchStatus(),e.startX=t.touches[0].clientX,e.startY=t.touches[0].clientY}),r(this,"touchMove",function(t){t=t.touches[0],e.deltaX=t.clientX-e.startX,e.deltaY=t.clientY-e.startY,e.offsetX=Math.abs(e.deltaX),e.offsetY=Math.abs(e.deltaY)}),r(this,"resetTouchStatus",function(){e.deltaX=0,e.deltaY=0,e.offsetX=0,e.offsetY=0}),this.deltaX=0,this.deltaY=0,this.offsetX=0,this.offsetY=0}function s(t){return"function"==typeof t}return function t(){var o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i(this,t),r(this,"initHtml",function(){o.el.style.background=o.options.inactiveColor,o.el.innerHTML='\n      <div class="v-slider-bar">\n        <div class="v-slider__button-wrapper">\n          <div class="v-slider__button"></div>\n        </div>\n      </div>\n    ',o.el.querySelector(".v-slider__button").style.width=o.options.buttonSize,o.el.querySelector(".v-slider__button").style.height=o.options.buttonSize,o.options.barHeight&&(o.el.style.height=o.options.barHeight,o.el.querySelector(".v-slider-bar").style.height=o.options.barHeight)}),r(this,"updateValue",function(t,e){t=o.format(t);var n=o.options.input,i=o.options.change;n&&(s(n)?n.call(o,t):console.warn("input is not a function")),e&&i&&(s(i)?i.call(o,t):console.warn("change is not a function")),o.value=t,o.render()}),r(this,"format",function(t){return Math.round(Math.max(o.min,Math.min(t,o.max))/o.step)*o.step}),r(this,"onClick",function(t){t.stopPropagation();var e=o.el.getBoundingClientRect(),t=t.clientX-e.left,e=e.width,e=+o.min+t/e*o.scope;o.startValue=o.value,o.updateValue(e,!0)}),r(this,"onTouchStart",function(t){o.touchMixin.touchStart(t),o.currentValue=o.value,o.startValue=o.format(o.value),o.dragStatus="start"}),r(this,"onTouchMove",function(t){var e=o.options.dragStart;"start"===o.dragStatus&&e&&(s(e)?e():console.warn("dragStart is not a function")),o.el.querySelector(".v-slider-bar").style.transition="none 0s ease 0s","boolean"==typeof(e=t).cancelable&&!e.cancelable||e.preventDefault(),e.stopPropagation(),o.touchMixin.touchMove(t),o.dragStatus="draging",t=o.el.getBoundingClientRect(),t=o.touchMixin.deltaX/t.width*o.scope,o.currentValue=o.startValue+t,o.updateValue(o.currentValue)}),r(this,"onTouchEnd",function(){var t;"draging"===o.dragStatus&&(o.updateValue(o.currentValue,!0),(t=o.options.dragEnd)&&(s(t)?t():console.warn("dragEnd is not a function"))),o.el.querySelector(".v-slider-bar").style.transition=null,o.dragStatus=""}),r(this,"bindTouchEvent",function(t){var e=o.onTouchStart,n=o.onTouchMove,i=o.onTouchEnd;t.addEventListener("touchstart",e),t.addEventListener("touchmove",n),i&&(t.addEventListener("touchend",i),t.addEventListener("touchcancel",i))}),r(this,"calcMainAxis",function(){var t=o.value,e=o.min,n=o.scope;return"".concat(100*(t-e)/n,"%")}),r(this,"calcOffset",function(){return o.value,o.min,o.scope,null}),r(this,"render",function(){var t={width:o.calcMainAxis(),background:o.options.activeColor},e=o.el.querySelector(".v-slider-bar");e.style.width=t.width,e.style.background=t.background}),this.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({min:0,max:100,step:1,value:0},e),this.min=this.options.min,this.max=this.options.max,this.step=this.options.step,this.value=this.options.value,this.el=function(t){if("string"==typeof t&&(t=document.querySelector(t)),("object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement))?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"===n(t)&&1===t.nodeType&&"string"==typeof t.nodeName})(t))return t;throw TypeError("el is not define")}(this.options.el),this.dragStatus="",this.scope=this.max-this.min,this.initHtml(),this.updateValue(this.value),e=this.el.querySelector(".v-slider__button-wrapper"),this.bindTouchEvent(e),this.touchMixin=new u,this.el.addEventListener("click",this.onClick)}},"object"==("undefined"==typeof exports?"undefined":o(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Slider=e(),function(){function e(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"init",function(){n.el.querySelector(".title").innerHTML=n.title,n.audioEl.setAttribute("src",n.url),n.getAudioInfo(),n.el.querySelector(".icon-audio").addEventListener("click",n.playAndPause)}),a(this,"initHtml",function(){n.el.innerHTML='\n      <span class="icon icon-audio"></span>\n      <div class="audio-info">\n        <div class="title"></div>\n        <div class="v-slider"></div>\n        <div class="audio-time">\n          <div class="audio-current">00:00</div>\n          <div class="audio-duration">00:00</div>\n        </div>\n      </div>\n      <audio class="audio-wapper" preload></audio>\n    '}),a(this,"initSlider",function(){n.slider=new Slider({el:n.el.querySelector(".v-slider"),step:.1,buttonSize:n.options.buttonSize||"10px",activeColor:n.options.activeColor||"#F45E23",change:n.changeTime})}),a(this,"playAndPause",function(){n.play=!n.play,n.showPlayFixed=!0;var t=n.audioEl;n.play?t.play():t.pause(),n.options.playStatus&&n.options.playStatus(n.play,n.el.dataset.index)}),a(this,"changeTime",function(t){var e=n.audioEl;e.currentTime=e.duration*t/100}),a(this,"getAudioInfo",function(){var e=n.audioEl;e.addEventListener("loadedmetadata",function(){n.duration=n.transTime(e.duration),n.el.querySelector(".audio-duration").innerHTML=n.duration}),e.addEventListener("timeupdate",function(){var t=Math.floor(e.currentTime)/Math.floor(e.duration)*100;n.currentTimeValue=parseInt(100*t)/100,n.currentTime=n.transTime(e.currentTime),n.slider.updateValue(n.currentTimeValue),n.el.querySelector(".audio-current").innerHTML=n.currentTime}),e.addEventListener("ended",function(){n.play=!1,n.showPlayFixed=!1,e.pause(),n.currentTime="00:00",n.currentTimeValue=0,n.slider.updateValue(n.currentTimeValue),n.el.querySelector(".audio-current").innerHTML=n.currentTime},!1)}),a(this,"transTime",function(t){var e=parseInt(t),t=parseInt(e/60),e=e%60+"";return 0===t?t="00":t<10&&(t="0"+t),1===e.length&&(e="0"+e),t+":"+e}),this.options=t,this.url=this.options.url,this.title=this.options.title,this.el=function(t){if("string"==typeof t&&(t=document.querySelector(t)),("object"===("undefined"==typeof HTMLElement?"undefined":o(HTMLElement))?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"===o(t)&&1===t.nodeType&&"string"==typeof t.nodeName})(t))return t;throw TypeError("el is not define")}(this.options.el),this.initHtml(),this.duration="00:00",this.currentTime="00:00",this.currentTimeValue=0,this.play=!1,this.showPlayFixed=!1,this.audioEl=this.el.querySelector(".audio-wapper"),this.init(),this.initSlider()}var t,n,i;return t=e,(n=[{key:"audioPause",value:function(){this.showPlayFixed=!1,this.play=!1,this.audioEl.pause()}}])&&r(t.prototype,n),i&&r(t,i),e}()});
