{"version":3,"file":"audioPlayer.js","sources":["../src/util.js","../src/index.js"],"sourcesContent":["export function getDom (el) {\n  if (typeof el === 'string') {\n    el = document.querySelector(el);\n  }\n\n  var isDOM = typeof HTMLElement === 'object'\n    ? function (el) {\n        return el instanceof HTMLElement;\n      }\n    : function (el) {\n        return el && typeof el === 'object' && el.nodeType === 1 && typeof el.nodeName === 'string';\n      };\n  if (isDOM(el)) {\n    return el;\n  } else {\n    throw TypeError('el is not define');\n  }\n}","import { getDom } from \"./util\";\n\nclass AudioPlayer {\n  constructor (options = {}) {\n    this.options = options;\n    this.url = this.options.url;\n    this.title = this.options.title;\n    this.el = getDom(this.options.el);\n    this.initHtml();\n    this.duration = '00:00';\n    this.currentTime = '00:00';\n    this.currentTimeValue = 0;\n    this.play = false;\n    this.showPlayFixed = false;\n    this.audioEl = this.el.querySelector('.audio-wapper');\n    this.init();\n    this.initSlider();\n  }\n  init = () => {\n    this.el.querySelector('.title').innerHTML = this.title;\n    this.audioEl.setAttribute('src', this.url);\n    this.getAudioInfo();\n    this.el.querySelector('.icon-audio').addEventListener('click', this.playAndPause)\n  }\n  initHtml = () => {\n    const html = `\n      <span class=\"icon icon-audio\"></span>\n      <div class=\"audio-info\">\n        <div class=\"title\"></div>\n        <div class=\"v-slider\"></div>\n        <div class=\"audio-time\">\n          <div class=\"audio-current\">00:00</div>\n          <div class=\"audio-duration\">00:00</div>\n        </div>\n      </div>\n      <audio class=\"audio-wapper\" preload></audio>\n    `\n    this.el.innerHTML = html;\n  }\n  initSlider = () => {\n    this.slider = new Slider({\n      el: this.el.querySelector('.v-slider'),\n      step: 0.1,\n      buttonSize: this.options.buttonSize || '10px',\n      activeColor: this.options.activeColor || '#F45E23',\n      change: this.changeTime\n    });\n  }\n  playAndPause = () => {\n    this.play = !this.play;\n    this.showPlayFixed = true;\n    let audio = this.audioEl;\n    if (this.play) {\n      audio.play();\n    } else {\n      audio.pause();\n    }\n    this.options.playStatus && this.options.playStatus(this.play, this.el.dataset.index);\n  }\n  audioPause () {\n    this.showPlayFixed = false;\n    this.play = false;\n    this.audioEl.pause();\n  }\n  changeTime = (val) => {\n    let audio = this.audioEl;\n    audio.currentTime = (audio.duration * val) / 100;\n  }\n  getAudioInfo = () => {\n    let audio = this.audioEl;\n    audio.addEventListener('loadedmetadata', () => {\n      this.duration = this.transTime(audio.duration);\n      this.el.querySelector('.audio-duration').innerHTML = this.duration;\n    });\n    audio.addEventListener('timeupdate', () => {\n      let value = (Math.floor(audio.currentTime) / Math.floor(audio.duration)) * 100;\n      this.currentTimeValue = (parseInt(value * 100)) / 100;\n      this.currentTime = this.transTime(audio.currentTime);\n      this.slider.updateValue(this.currentTimeValue);\n      this.el.querySelector('.audio-current').innerHTML = this.currentTime;\n    });\n    audio.addEventListener('ended', () => {\n      this.play = false;\n      this.showPlayFixed = false;\n      audio.pause();\n      this.currentTime = '00:00';\n      this.currentTimeValue = 0;\n      this.slider.updateValue(this.currentTimeValue);\n      this.el.querySelector('.audio-current').innerHTML = this.currentTime;\n    }, false);\n  }\n  transTime = (time) => {\n    let duration = parseInt(time);\n    let minute = parseInt(duration / 60);\n    let sec = duration % 60 + '';\n    let isM0 = ':';\n    if (minute === 0) {\n      minute = '00';\n    } else if (minute < 10) {\n      minute = '0' + minute;\n    }\n    if (sec.length === 1) {\n      sec = '0' + sec;\n    }\n    return minute + isM0 + sec;\n  }\n};\n\nexport default AudioPlayer;"],"names":["getDom","el","document","querySelector","isDOM","HTMLElement","nodeType","nodeName","TypeError","AudioPlayer","options","innerHTML","title","audioEl","setAttribute","url","getAudioInfo","addEventListener","playAndPause","html","slider","Slider","step","buttonSize","activeColor","change","changeTime","play","showPlayFixed","audio","pause","playStatus","dataset","index","val","currentTime","duration","transTime","value","Math","floor","currentTimeValue","parseInt","updateValue","time","minute","sec","isM0","length","initHtml","init","initSlider"],"mappings":"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"}